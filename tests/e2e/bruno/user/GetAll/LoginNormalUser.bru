meta {
  name: LoginNormalUser
  type: http
  seq: 4.8
}

post {
  url: {{baseURL}}/auth/login
  body: json
  auth: bearer
}

params:query {
  ~:
}

headers {
  Accept-Language: es-ES
}

auth:bearer {
  token:
}

body:json {
  {
    "email": "{{normalUserEmail}}",
    "password": "{{strongPassword}}"
  }
}

script:post-response {
  const response = res.getBody()

  test("Status code is 200", function () {
      expect(res.getStatus()).to.equal(200);
  });

  test("Access Token is present", function () {
      expect(response.data.accessToken).to.not.be.null;
  });

  test("Refresh Token is present", function () {
      expect(response.data.refreshToken).to.not.be.null;
  });

  bru.setEnvVar("userToken", response.data.accessToken);
  bru.setEnvVar("refreshUserToken", response.data.refreshToken);
}

settings {
  encodeUrl: true
  timeout: 0
}
